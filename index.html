<div id="ai-app" style="font-family: 'Segoe UI', Arial, sans-serif; border:2px solid #ffcc00; padding:30px; border-radius:15px; text-align:center; background: #1a1a1a; color: white; max-width: 500px; margin: 20px auto; box-shadow: 0 10px 30px rgba(0,0,0,0.5);">
    <h2 style="color:#ffcc00; text-transform: uppercase; letter-spacing: 2px;">OrbitScan AI Scanner v2.0</h2>
    <p style="opacity: 0.8;">–°–∏—Å—Ç–µ–º–∞ –ò–ò-–∞–Ω–∞–ª–∏–∑–∞ –∫–æ—Å–º–∏—á–µ—Å–∫–∏—Ö –æ–±—ä–µ–∫—Ç–æ–≤</p>
    
    <input type="file" id="file-input" accept="image/*" style="display:none;">
    <button onclick="document.getElementById('file-input').click()" style="background:#ffcc00; color:#000; border:none; padding:15px 30px; border-radius:50px; cursor:pointer; font-weight:bold; transition: 0.3s; box-shadow: 0 4px 15px rgba(255,204,0,0.3);">–í–´–ë–†–ê–¢–¨ –°–ù–ò–ú–û–ö</button>
    
    <div style="margin-top:25px; border: 1px dashed #444; border-radius: 10px; padding: 10px;">
        <img id="preview" style="max-width:100%; height:200px; display:none; border-radius:8px; margin: 0 auto;">
    </div>

    <div id="result-label" style="font-size:20px; font-weight:bold; margin-top:20px; letter-spacing: 1px;">–û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–∏—Å—Ç–µ–º—ã...</div>
</div>

<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest/dist/tf.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@latest/dist/teachablemachine-image.min.js"></script>

<script>
    // –¢–≤–æ—è –û–ë–ù–û–í–õ–ï–ù–ù–ê–Ø —Å—Å—ã–ª–∫–∞ –Ω–∞ –º–æ–¥–µ–ª—å —Å 3 –∫–ª–∞—Å—Å–∞–º–∏
    const MODEL_URL = "https://teachablemachine.withgoogle.com/models/12f_3hU3C/"; 
    let model;

    async function loadModel() {
        try {
            model = await tmImage.load(MODEL_URL + "model.json", MODEL_URL + "metadata.json");
            document.getElementById('result-label').innerHTML = "üü¢ –°–ò–°–¢–ï–ú–ê –ì–û–¢–û–í–ê";
        } catch (e) {
            document.getElementById('result-label').innerHTML = "‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥–µ–ª–∏";
        }
    }
    loadModel();

    document.getElementById('file-input').addEventListener('change', async (e) => {
        const file = e.target.files[0];
        if (!file) return;

        const img = document.getElementById('preview');
        img.src = URL.createObjectURL(file);
        img.style.display = 'block';

        const resultDiv = document.getElementById('result-label');
        resultDiv.innerHTML = "üõ∞Ô∏è –ò–î–ï–¢ –ò–î–ï–ù–¢–ò–§–ò–ö–ê–¶–ò–Ø...";
        resultDiv.style.color = "#ffcc00";

        img.onload = async () => {
            const prediction = await model.predict(img);
            
            let topClass = "";
            let topProb = 0;
            
            prediction.forEach(p => {
                if(p.probability > topProb) {
                    topProb = p.probability;
                    topClass = p.className;
                }
            });

            // –õ–û–ì–ò–ö–ê –î–õ–Ø 3-–• –ö–õ–ê–°–°–û–í
            // –í–∞–∂–Ω–æ: –ø—Ä–æ–≤–µ—Ä—å, —á—Ç–æ–±—ã –Ω–∞–∑–≤–∞–Ω–∏—è –∫–ª–∞—Å—Å–æ–≤ –≤ Teachable Machine —Å–æ–≤–ø–∞–¥–∞–ª–∏ (damage / clear / unknown)
            if (topClass === "damage") {
                resultDiv.innerHTML = "‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï: –û–ë–ù–ê–†–£–ñ–ï–ù–û –ü–û–í–†–ï–ñ–î–ï–ù–ò–ï!";
                resultDiv.style.color = "#ff4d4d";
            } else if (topClass === "clear") {
                resultDiv.innerHTML = "‚úÖ –û–ë–™–ï–ö–¢ –ò–î–ï–ù–¢–ò–§–ò–¶–ò–†–û–í–ê–ù: –¶–ï–õ";
                resultDiv.style.color = "#4dff88";
            } else {
                // –ï—Å–ª–∏ —Å—Ä–∞–±–æ—Ç–∞–ª —Ç—Ä–µ—Ç–∏–π –∫–ª–∞—Å—Å (–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –æ–±—ä–µ–∫—Ç)
                resultDiv.innerHTML = "‚ùì –û–ë–™–ï–ö–¢ –ù–ï –û–ü–û–ó–ù–ê–ù (–ù–ï –°–ü–£–¢–ù–ò–ö)";
                resultDiv.style.color = "#aaaaaa";
            }
        };
    });
</script>
