<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OrbitScan AI v2.0</title>
</head>
<body style="background-color: #0d0d0d; margin: 0; display: flex; justify-content: center; align-items: center; height: 100vh;">

<div id="ai-app" style="font-family: 'Segoe UI', Arial, sans-serif; border:2px solid #ffcc00; padding:30px; border-radius:15px; text-align:center; background: #1a1a1a; color: white; max-width: 500px; width: 90%; box-shadow: 0 10px 30px rgba(0,0,0,0.5);">
    
    <h2 style="color:#ffcc00; text-transform: uppercase; letter-spacing: 2px; margin-bottom: 5px;">OrbitScan AI Scanner</h2>
    <p style="opacity: 0.7; font-size: 14px; margin-bottom: 25px;">–°–∏—Å—Ç–µ–º–∞ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –¥–µ—Ñ–µ–∫—Ç–æ–≤ v2.0</p>
    
    <input type="file" id="file-input" accept="image/*" style="display:none;">
    
    <button onclick="document.getElementById('file-input').click()" style="background:#ffcc00; color:#000; border:none; padding:15px 30px; border-radius:50px; cursor:pointer; font-weight:bold; transition: 0.3s; box-shadow: 0 4px 15px rgba(255,204,0,0.3); text-transform: uppercase;">
        –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å–Ω–∏–º–æ–∫
    </button>
    
    <div style="margin-top:25px; border: 1px dashed #444; border-radius: 10px; padding: 10px; min-height: 150px; display: flex; align-items: center; justify-content: center;">
        <img id="preview" style="max-width:100%; max-height:250px; display:none; border-radius:8px;">
        <div id="placeholder-text" style="color: #666;">–°–Ω–∏–º–æ–∫ –Ω–µ –≤—ã–±—Ä–∞–Ω</div>
    </div>

    <div id="result-label" style="font-size:18px; font-weight:bold; margin-top:25px; padding: 15px; border-radius: 8px; background: rgba(255,255,255,0.05);">
        –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–∏—Å—Ç–µ–º—ã...
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest/dist/tf.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@latest/dist/teachablemachine-image.min.js"></script>

<script>
    // –¢–≤–æ—è —Å—Å—ã–ª–∫–∞ –Ω–∞ –º–æ–¥–µ–ª—å
    const MODEL_URL = "https://teachablemachine.withgoogle.com/models/12f_3hU3C/"; 
    let model;

    // –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
    async function loadModel() {
        try {
            model = await tmImage.load(MODEL_URL + "model.json", MODEL_URL + "metadata.json");
            document.getElementById('result-label').innerHTML = "üü¢ –°–ò–°–¢–ï–ú–ê –ì–û–¢–û–í–ê –ö –†–ê–ë–û–¢–ï";
            document.getElementById('result-label').style.color = "#4dff88";
        } catch (e) {
            document.getElementById('result-label').innerHTML = "‚ùå –û–®–ò–ë–ö–ê –ó–ê–ì–†–£–ó–ö–ò –ú–û–î–ï–õ–ò";
            document.getElementById('result-label').style.color = "#ff4d4d";
        }
    }
    loadModel();

    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–∞
    document.getElementById('file-input').addEventListener('change', async (e) => {
        const file = e.target.files[0];
        if (!file) return;

        // –ü–æ–∫–∞–∑ –∫–∞—Ä—Ç–∏–Ω–∫–∏
        const img = document.getElementById('preview');
        const placeholder = document.getElementById('placeholder-text');
        img.src = URL.createObjectURL(file);
        img.style.display = 'block';
        placeholder.style.display = 'none';

        const resultDiv = document.getElementById('result-label');
        resultDiv.innerHTML = "üõ∞Ô∏è –ê–ù–ê–õ–ò–ó –û–ë–™–ï–ö–¢–ê...";
        resultDiv.style.color = "#ffcc00";

        img.onload = async () => {
            // –ó–∞–ø—É—Å–∫ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
            const prediction = await model.predict(img);
            
            let topClass = "";
            let topProb = 0;
            
            // –ü–æ–∏—Å–∫ —Å–∞–º–æ–≥–æ –≤–µ—Ä–æ—è—Ç–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞
            prediction.forEach(p => {
                if(p.probability > topProb) {
                    topProb = p.probability;
                    topClass = p.className;
                }
            });

            // –õ–û–ì–ò–ö–ê –û–ü–†–ï–î–ï–õ–ï–ù–ò–Ø (–ø–æ–¥ —Ç–≤–æ–∏ 3 –∫–ª–∞—Å—Å–∞)
            if (topClass === "damage") {
                resultDiv.innerHTML = "‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –£–†–û–í–ï–ù–¨: –û–ë–ù–ê–†–£–ñ–ï–ù–û –ü–û–í–†–ï–ñ–î–ï–ù–ò–ï";
                resultDiv.style.color = "#ff4d4d";
            } 
            else if (topClass === "clear") {
                resultDiv.innerHTML = "‚úÖ –°–¢–ê–¢–£–°: –û–ë–™–ï–ö–¢ –¶–ï–õ / –ù–û–†–ú–ê";
                resultDiv.style.color = "#4dff88";
            } 
            else if (topClass === "Not satellite") {
                resultDiv.innerHTML = "‚ùì –û–ë–™–ï–ö–¢ –ù–ï –ò–î–ï–ù–¢–ò–§–ò–¶–ò–†–û–í–ê–ù (–ù–ï –°–ü–£–¢–ù–ò–ö)";
                resultDiv.style.color = "#aaaaaa";
            }
        };
    });
</script>

</body>
</html>
